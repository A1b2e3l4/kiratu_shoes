{% extends "admin/base.html" %}
{% block title %}Users â€“ Admin{% endblock %}
{% block admin_content %}

<h2 style="font-family:'Playfair Display',serif;margin-bottom:1.5rem;">User Management</h2>

<div class="table-wrap">
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Verified</th>
                <th>Role</th>
                <th>Joined</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td><strong>{{ user['first_name'] ~ ' ' ~ user['last_name'] }}</strong></td>
                <td>{{ user['email'] }}</td>
                <td>
                    {% if user['is_verified'] %}
                    <span style="color:var(--success);">âœ…</span>
                    {% else %}
                    <span style="color:var(--danger);">âŒ</span>
                    {% endif %}
                </td>
                <td>
                    {% if user['is_admin'] %}
                    <span style="background:rgba(200,169,110,0.2);color:var(--gold-dark);padding:0.2rem 0.7rem;border-radius:50px;font-size:0.75rem;font-weight:700;">Admin</span>
                    {% else %}
                    <span style="background:rgba(52,152,219,0.15);color:#2980b9;padding:0.2rem 0.7rem;border-radius:50px;font-size:0.75rem;">User</span>
                    {% endif %}
                </td>
                <td style="color:var(--text-muted);font-size:0.85rem;">{{ user['created_at']|fmtd }}</td>
                <td>
                    <div class="d-flex gap-1 flex-wrap">
                        <a href="{{ url_for('admin_user_detail', uid=user['id']) }}" class="btn btn-sm btn-outline-gold">View</a>
                        {% if not user['is_admin'] %}
                        <form method="POST" action="{{ url_for('admin_promote_user', uid=user['id']) }}" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-dark" title="Make admin">â¬†ï¸</button>
                        </form>
                        {% elif user['email'] != 'kiratushoes@gmail.com' %}
                        <form method="POST" action="{{ url_for('admin_demote_user', uid=user['id']) }}" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-outline-gold" title="Remove admin">â¬‡ï¸</button>
                        </form>
                        {% endif %}
                        {% if user['email'] != 'kiratushoes@gmail.com' %}
                        <form method="POST" action="{{ url_for('admin_delete_user', uid=user['id']) }}"
                              onsubmit="return confirmDelete('Delete this user?')" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-danger">ğŸ—‘ï¸</button>
                        </form>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
